!function(d,s){"use strict";d.component("cart:floating-bag",{active:!0,init:function(){s(".minicart--floating-cart").length&&(this.listeners().triggers(),this.setFloatingCartPosition())},listeners:function(){var t=this;return s(".minicart--floating-cart").on("floating-cart:remove-product",".floating-cart--remove-product",function(){t.removeProduct(s(this).parents(".floating-cart--item"))}),t},triggers:function(){return s(".minicart--floating-cart").on("click",".floating-cart--remove-product",function(t){t.preventDefault(),s(this).trigger("floating-cart:remove-product")}),this},removeProduct:function(t){var a=s("#floating-cart--remove-form"),r=(a.find("[name=entryNumber]").remove(),t.attr("data-index")),n=t.attr("data-brand"),i=t.attr("data-code"),e=t.attr("data-name"),o=t.attr("data-price"),c=t.attr("data-quantity"),g=t.attr("data-category"),l=t.attr("data-originalPrice"),i={id:i,brand:n,category:g,name:e,variant:t.attr("data-variant"),position:r,price:o,originalPrice:l,quantity:c};s("<input/>",{name:"entryNumber",value:r,type:"hidden"}).appendTo(a),window.dataLayer.push({event:"removeFromCart",product:i,quantity:c}),s.ajax({type:"POST",dataType:"json",url:a.attr("action"),data:a.serialize()}).done(function(t){s("body").hasClass("page-cartPage")?window.location.href="/cart":d.components["cart:floating-bag"].loadFloatingCartProducts(t)}).error(function(t){console.error(t)})},loadFloatingCartContent:function(){s.get("/cart/rollover/MarisaMiniCart/?_noCacheToIE="+(new Date).getTime()).done(function(t){var t=JSON.parse(t),a=JSON.stringify(t);localStorage.removeItem("MarisaMiniCart"),localStorage.setItem("MarisaMiniCart",a),d.components["cart:floating-bag"].loadFloatingCartProducts(t)}).error(function(t){console.error(t)})},setFloatingCartPosition:function(){var t=s(".shopping-bag .mini-badge").position();s(".minicart--floating-cart").outerWidth();s(".minicart--floating-cart").css({right:-t.left})},loadFloatingCartProducts:function(t){var a,r,n;s(".floating-cart--main-content").html(""),t.entries.length?(a=t.totalCartPrice,r=t.numberItemsInCart,n=s(".floating-cart--clone-nodes .floating-cart--item").first().clone(),s.each(t.entries,function(t,a){n.find(".floating-cart--product-name").trigger("floating-cart:update-product-name",a).find("span").text(a.name),n.find(".floating-cart--product-image").trigger("floating-cart:update-product-image",a).find("img").attr("src",a.image),n.find(".floating-cart--product-price").trigger("floating-cart:update-product-price",a).find("strong").text(a.price),n.find(".floating-cart-item--quantity").text(function(){return s(this).trigger("floating-cart:update-product-quantity",a),"Quantidade: "+a.quantity}),n.attr("data-index",a.entryNumber),s(".floating-cart--main-content").append(n).trigger("floating-cart:add-cloned-item",n)}),s(".floating-cart--cart-total").text(function(){return s(this).trigger("floating-cart:update-cart-total"),a}),s(".floating-cart--cart-quantity").text(function(){return s(this).trigger("floating-cart:update-cart-quantity",r),1===r?r+" itens na sacola:":r+" item na sacola: "}),s(".mini-badge").text(r),"cartPage"==s("body").attr("data-page-uid")&&(1==r?s("#numItensCard").text("( "+r+s("#labelItem").val()+")"):s("#numItensCard").text("( "+r+s("#labelItens").val()+")")),s(".minicart-total .price").text(a),s(".floating-cart--promotions p").text(t.messageFreeDelivery),s(".floating-cart--cart-installments").text(t.installmentMessage),s(".floating-cart--main-header, .floating-cart--main-footer").removeClass("hidden"),recalcMatchHeight("floating-cart--totals")):(s(".floating-cart--main-header, .floating-cart--main-footer").addClass("hidden"),s(".mini-badge").text("0"),s(".minicart-total").find(".price").text("R$ 0,00"))}})}(Marisa,jQuery);