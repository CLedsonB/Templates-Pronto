ACC.address={_autoload:["bindToChangeAddressButton","bindCreateUpdateAddressForm","bindSuggestedDeliveryAddresses","bindCountrySpecificAddressForms","showAddressFormButtonPanel","bindViewAddressBook","bindToColorboxClose","showRemoveAddressFromBookConfirmation","backToListAddresses"],spinner:$("<img src='"+ACC.config.commonResourcePath+"/images/spinner.gif' />"),addressID:"",handleChangeAddressButtonClick:function(){return ACC.address.addressID=$(this).data("address")?$(this).data("address"):"",$("#summaryDeliveryAddressFormContainer").show(),$("#summaryOverlayViewAddressBook").show(),$("#summaryDeliveryAddressBook").hide(),$.getJSON(getDeliveryAddressesUrl,ACC.address.handleAddressDataLoad),!1},handleAddressDataLoad:function(e){ACC.address.setupDeliveryAddressPopupForm(e),ACC.colorbox.open("",{inline:!0,href:"#summaryDeliveryAddressOverlay",overlayClose:!1,onOpen:function(){ACC.address.emptyAddressForm(),$(document).on("change","#saveAddress",function(){var e=$(this).prop("checked");$("#defaultAddress").prop("disabled",!e),e||$("#defaultAddress").prop("checked",!1)})}})},setupDeliveryAddressPopupForm:function(e){$("#summaryDeliveryAddressBook").html($("#deliveryAddressesTemplate").tmpl({addresses:e})),$("#summaryDeliveryAddressBook button.use_address").click(ACC.address.handleSelectExistingAddressClick),$("#summaryDeliveryAddressBook button.edit").click(ACC.address.handleEditAddressClick),$("#summaryDeliveryAddressBook button.default").click(ACC.address.handleDefaultAddressClick)},emptyAddressForm:function(){var e={url:getDeliveryAddressFormUrl,data:{addressId:ACC.address.addressID,createUpdateStatus:""},type:"GET",success:function(e){$("#summaryDeliveryAddressFormContainer").html(e),ACC.address.bindCreateUpdateAddressForm()}};$.ajax(e)},handleSelectExistingAddressClick:function(){var e=$(this).attr("data-address");return $.postJSON(setDeliveryAddressUrl,{addressId:e},ACC.address.handleSelectExitingAddressSuccess),!1},handleEditAddressClick:function(){$("#summaryDeliveryAddressFormContainer").show(),$("#summaryOverlayViewAddressBook").show(),$("#summaryDeliveryAddressBook").hide();var e=$(this).attr("data-address"),e={url:getDeliveryAddressFormUrl,data:{addressId:e,createUpdateStatus:""},target:"#summaryDeliveryAddressFormContainer",type:"GET",success:function(e){ACC.address.bindCreateUpdateAddressForm(),ACC.colorbox.resize()},error:function(e,s,d){alert("Failed to update cart. Error details ["+e+", "+s+", "+d+"]")}};return $(this).ajaxSubmit(e),!1},handleDefaultAddressClick:function(){var e=$(this).attr("data-address"),e={url:setDefaultAddressUrl,data:{addressId:e},type:"GET",success:function(e){ACC.address.setupDeliveryAddressPopupForm(e)},error:function(e,s,d){alert("Failed to update address book. Error details ["+e+", "+s+", "+d+"]")}};return $(this).ajaxSubmit(e),!1},handleSelectExitingAddressSuccess:function(e){null!=e?(ACC.refresh.refreshPage(e),ACC.colorbox.close()):alert("Failed to set delivery address")},bindCreateUpdateAddressForm:function(){$(".create_update_address_form").each(function(){var e={type:"POST",beforeSubmit:function(){$("#checkout_delivery_address").block({message:ACC.address.spinner})},success:function(e){$("#summaryDeliveryAddressFormContainer").html(e);e=$(".create_update_address_id").attr("status");null!=e&&"success"===e.toLowerCase()?(ACC.refresh.getCheckoutCartDataAndRefreshPage(),ACC.colorbox.close()):(ACC.address.bindCreateUpdateAddressForm(),ACC.colorbox.resize())},error:function(e,s,d){alert("Failed to update cart. Error details ["+e+", "+s+", "+d+"]")},complete:function(){$("#checkout_delivery_address").unblock()}};$(this).ajaxForm(e)})},refreshDeliveryAddressSection:function(e){$(".summaryDeliveryAddress").replaceWith($("#deliveryAddressSummaryTemplate").tmpl(e))},bindSuggestedDeliveryAddresses:function(){var e=$(".add_edit_delivery_address_id").attr("status");null!=e&&"hasSuggestedAddresses"==e&&ACC.address.showSuggestedAddressesPopup()},showSuggestedAddressesPopup:function(){ACC.colorbox.open("",{href:"#popup_suggested_delivery_addresses",inline:!0,overlayClose:!1,width:525})},bindCountrySpecificAddressForms:function(){$(document).on("change","#countrySelector select",function(){var e={addressCode:"",countryIsoCode:$(this).val()};ACC.address.displayCountrySpecificAddressForm(e,ACC.address.showAddressFormButtonPanel)})},showAddressFormButtonPanel:function(){""!==$("#countrySelector :input").val()&&$("#addressform_button_panel").show()},bindToColorboxClose:function(){$(document).on("click",".closeColorBox",function(){ACC.colorbox.close()})},displayCountrySpecificAddressForm:function(e,s){$.ajax({url:ACC.config.encodedContextPath+"/my-account/addressform",async:!0,data:e,dataType:"html",beforeSend:function(){$("#i18nAddressForm").html(ACC.address.spinner)}}).done(function(e){$("#i18nAddressForm").html($(e).html()),"function"==typeof s&&s.call()})},bindToChangeAddressButton:function(){$(document).on("click",".summaryDeliveryAddress .editButton",ACC.address.handleChangeAddressButtonClick)},bindViewAddressBook:function(){$(document).on("click",".js-address-book",function(e){e.preventDefault(),ACC.colorbox.open("Saved Addresses",{href:"#addressbook",inline:!0,width:"380px"})}),$(document).on("click","#summaryOverlayViewAddressBook",function(){$("#summaryDeliveryAddressFormContainer").hide(),$("#summaryOverlayViewAddressBook").hide(),$("#summaryDeliveryAddressBook").show(),ACC.colorbox.resize()})},showRemoveAddressFromBookConfirmation:function(){$(document).on("click",".removeAddressFromBookButton",function(){var e=$(this).data("addressId"),s=$(this).data("popupTitle");ACC.colorbox.open(s,{inline:!0,height:!1,href:"#popup_confirm_address_removal_"+e,onComplete:function(){$(this).colorbox.resize()}})})},backToListAddresses:function(){$(".addressBackBtn").on("click",function(){var e=$(this).data("backToAddresses");window.location=e})}};