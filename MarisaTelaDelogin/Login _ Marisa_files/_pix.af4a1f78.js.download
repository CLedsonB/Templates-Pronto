!function(e,l,c){"use strict";var p,n;Marisa.components.carousels;e.component("pix",{active:!0,formPaymentPix:function(i){l(document).ready(function(){Marisa.components["page:tools"].loaderMaster(!0);let e="";var a=l(".orderID").val(),s=l("body").attr("data-page-uid");if("order"==s&&(e="/my-account/setpayment-pix?orderCode="),"orderConfirmationPage"==s&&(e="/checkout/single/summary/setpayment-pix?orderCode="),"order"==s){var s=l("#js-payment-type").val(),t=l(".PAGAMENTO_CONFIRMADO").hasClass("active");if("PIX"==s&&t)return l(".js-pix-show-container").addClass("hidden"),l(".js-expired-pix").addClass("hidden"),setTimeout(function(){Marisa.components["page:tools"].loaderMaster(!1)},1e3),!1}l.ajax({url:e+a,type:"GET",dataType:"json",data:i}).done(function(a){var e=a.pix,o=e.pspReferenceId,s=e.pixStatus,r=e.expiredPixTime,d=e.pixTimer;l(".js-show-pix-buy").removeClass("hidden"),""!==s?(l.each(e,function(e,a){a=a.value;"QRCODE"==e&&l(".js-qrcode-show").html('<img src="'+a+'" width="180" height="180"/>'),"QRCODECONTENT"==e&&l.ajax({url:a,type:"GET",success:function(e){l(".js-show-code-pix").val(e),l(".js-pix-succes-info-show").removeClass("hidden")},error:function(e){console.error()}})}),l(".js-copy-pix").click(function(){l(".js-show-code-pix").attr("readonly",!1),l(".js-show-code-pix").select(),document.execCommand("copy"),l(".js-show-code-pix").attr("readonly",!0)}),l(".js-pspReferenceId").val(o),l(".js-status-pix").attr("data-status-pix",""),l(".js-pix-show-container").removeClass("hidden"),l(".js-buy-pix").removeClass("hidden"),"AUTHORIZED"!=s&&"COMPLETED"!=s||(clearInterval(n),l(".js-authorized-pix").removeClass("hidden"),l(".js-pix-show-container").addClass("hidden"),l(".js-expired-pix").addClass("hidden"),l(".js-status-pix").attr("data-status-pix","AUTHORIZED"),Marisa.components["page:tools"].loaderMaster(!1)),""!=r&&(jQuery(function(e){var a,s,t,i,n=r/6e4,n=(e(".js-delay-auto-cancel").html(d),60*n),e=e(".js-delay-pix-show");a=e,i=n,p!==c&&clearInterval(p),p=setInterval(function(){s=parseInt(i/60,10),t=parseInt(i%60,10),s=s<10?"0"+s:s,t=t<10?"0"+t:t,a.text(s+":"+t),--i<0&&(i=0,clearInterval(p),p=c,"AUTHORIZED"!=l(".js-status-pix").attr("data-status-pix")&&(l(".js-expired-pix").removeClass("hidden"),l(".js-status-pix").attr("data-status-pix","CANCELLED"),l(".js-pix-show-container").addClass("hidden"),l(".js-buy-pix").addClass("hidden"),l.post("/marisaomniwebservices/v2/marisa/pixpayment/status/cancel?pspReferenceId="+o,"json").done(function(){console.log("Pix payment successfully cancelled")}).fail(function(e){console.log("Error cancelling pix payment"),console.log(e)}).always(function(){})))},1e3)}),l(document).ready(function(){n=setInterval(function(){var e=l(".js-status-pix").attr("data-status-pix");l.ajax({url:"/marisaomniwebservices/v2/marisa/pixpayment/status?pspReferenceId="+o,type:"GET",dataType:"json",data:a}).done(function(e){e=e.status;"CANCELLED"==e&&(clearInterval(n),l(".js-expired-pix").removeClass("hidden"),l(".js-pix-show-container").addClass("hidden"),l(".js-authorized-pix").addClass("hidden")),"AUTHORIZED"!=e&&"COMPLETED"!=s||(clearInterval(n),l(".js-authorized-pix").removeClass("hidden"),l(".js-pix-show-container").addClass("hidden"),l(".js-expired-pix").addClass("hidden"),l(".js-status-pix").attr("data-status-pix","AUTHORIZED"))}).fail(function(){console.log("error"),clearInterval(n)}).always(function(){}),"CANCELLED"==e&&(l(".js-status-pix").attr("data-status-pix",""),clearInterval(n)),"AUTHORIZED"!=e&&"COMPLETED"!=s||(l(".js-buy-pix").removeClass("js-call-modal-waiting-payment-pix").removeAttr("data-target"),l(".js-authorized-pix").removeClass("hidden"),l(".js-expired-pix").addClass("hidden"),l(".js-pix-show-container").addClass("hidden"),clearInterval(n))},3e3)}))):(l(".js-expired-pix").removeClass("hidden"),l(".js-pix-show-container").addClass("hidden"),l(".js-authorized-pix").addClass("hidden"))}).fail(function(){console.log("error"),l(".js-show-pix-buy").addClass("hidden"),clearInterval(n)}),setTimeout(function(){Marisa.components["page:tools"].loaderMaster(!1)},2e3)})},cancelPaymentPix:function(){l.ajax({url:"/marisaomniwebservices/v2/marisa/pixpayment/status/cancel?pspReferenceId="+globalPspReferenceId,type:"POST",dataType:"json"}).done(function(){console.log("Pix payment successfully cancelled")}).fail(function(e){console.log("Error cancelling pix payment"),console.log(e)}).always(function(){})}})}(Marisa,jQuery);