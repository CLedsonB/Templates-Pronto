!function(r,t){"use strict";r.component("cart:voucher",{active:!0,removeVoucher:function(e){e=t("#numDiscountCoupon").val();var a=this;t.ajax({url:ACC.config.encodedContextPath+"/voucher/"+e+"/remove",type:"DELETE",success:function(r){Marisa.components["cart:voucher"].lock.call(a),t("#numDiscountCoupon").val(""),t(".voucher--controls-wrapper").find(".span_error")&&t(".voucher--controls-wrapper").find(".span_error").remove(),t("#subTotal").html(r.cartData.subTotal.formattedValue),t("#totalDiscounts").html(r.cartData.totalDiscounts.formattedValue),t("#cart--delivery-cost").html(r.cartData.deliveryCost.formattedValue),t("#totalOrder").html(r.cartData.totalPrice.formattedValue)},error:function(r){logWarn("[!] Error while removing voucher from cart."),logWarn("[!] Voucher code:",e),logWarn("[!] Status",r.statusText)}})},confirmVoucher:function(){var r,e=t(this).find('[type="submit"]'),a=t(this).find("#voucher-code");a.val().trim().length?(r=t(this),t.ajax({url:r.attr("action"),type:r.attr("method"),data:r.serialize(),success:function(r){r.successMsg?(e.attr("disabled",!0),a.attr("disabled",!0),t(".cart--lock-voucher-wrapper").removeClass("hidden").find(".cart--remove-voucher").attr("data-voucher-code",a.val()),t(".cart--voucher-messages").removeClass("hidden").empty().append(t("<p />",{class:"bg-success help-block",text:r.successMsg}))):r.errorMsg&&(e.attr("disabled",!1),a.attr("disabled",!1).focus(),t(".cart--lock-voucher-wrapper").addClass("hidden"),t(".cart--voucher-messages").removeClass("hidden").empty().append(t("<p />",{class:"bg-danger help-block",text:r.errorMsg})))},error:function(r){logWarn("[!] Error while adding voucher to cart."),logWarn("[!] Voucher code:",a.val()),logWarn("[!] Status",r.statusText)}})):a.focus()},lock:function(){var r=t(this).parents(".form-group");r.find("hgroup .pull-right").removeClass("hidden"),r.find(".voucher--controls-wrapper").addClass("hidden"),r.find('[type="submit"]').attr("disabled",!1),r.find("#voucher-code").attr("disabled",!1).val(""),r.find(".cart--lock-voucher-wrapper").addClass("hidden"),r.find(".add-voucher").removeClass("hidden")},unlock:function(){var r=t(this).parents(".form-group");r.find("hgroup .pull-right").addClass("hidden"),r.find(".voucher--controls-wrapper, .cart--lock-voucher-wrapper").removeClass("hidden"),r.find(".add-voucher").addClass("hidden"),recalcMatchHeight()}})}(Marisa,jQuery);