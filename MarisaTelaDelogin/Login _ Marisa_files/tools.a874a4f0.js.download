!function(i,s){"use strict";var t=window.location.origin,a="/cart"!==window.location.pathname,n=Marisa.components.formatValueCjn,l=s(document).find(".js-load-users-menu"),c=s(document).find(".js-load-mini-cart-menu");i.component("page:tools",{active:!0,name:"Tools",init:function(){var e=this;s(document).ready(function(){s(this).trigger("page:tools"),-1!=navigator.userAgent.indexOf("Trident")&&setTimeout(function(){s(".slick-list.draggable").height(s(".slick-slide[aria-describedby=slick-slide00]").height())},500),s(":input").on("invalid",function(e){e.preventDefault()}),s("input[data-currency=true]").on("blur",function(){var e=s(this).val();s(this).val("R$ "+n.formatValueCjn2(e))}),s("input[data-currency=true]").each(function(e,t){var a=s(this).val();s(this).val("R$ "+n.formatValueCjn2(a))}),s("#nameEmailNL, #emailEmailNL").on("keypress",function(e){13==(e.keyCode||e.which)&&s("#sendMailNewsLetter").click()}),s("#sendMailNewsLetter").on("click",function(){var e=s("#newsletterSubscriptionFormComponent").serialize();s.ajax({url:t+"/newsletter/newsletter-register",type:"POST",data:e,success:function(e,t,a){s("#modalErrorEmailNewl").html(e),s("#showModalErrorEmail").click(),s(".btn-confim-sendNewLetter").removeAttr("id"),s(".btn-confim-sendNewLetter").attr("id","confirmation-send-email");e=s("#emailEmailNL").val();window.dataLayer.push({event:"newsletter",email:e}),s("#confirmation-send-email").off("click").on("click",function(){s("#newsletterSubscriptionFormComponent input[type=text]").val("")})},error:function(e,t){console.log(e.responseText),s("#modalErrorEmailNewl").html(e.responseText),s("#showModalErrorEmail").click()}})}),s("#modal--faq-send-email").on("show.bs.modal",function(){""!=s("#faqFirstName").val()&&s("#faqFirstName").attr("readonly","true"),""!=s("#faqClientEmail").val()&&s("#faqClientEmail").attr("readonly","true"),""!=s("#faqCpfCnpj").val()&&s("#faqCpfCnpj").attr("readonly","true")}),Marisa.components["page:tools"].asyncHeaderWhippet("user",l),Marisa.components["page:tools"].asyncHeaderWhippet("cart",c)}),s(document).on("page:tools",function(){e.listeners().triggers()}),Marisa.components["page:tools"].getParametersFromUrlToCookies(),Marisa.components["page:tools"].removeErrorForm(),Marisa.components["page:tools"].lowerCaseEmails(),Marisa.components["page:tools"].lgpd(),s("#gotToTop").on("click",Marisa.components["page:tools"].goToTopSite)},goToTopSite:function(){jQuery.fn.extend({scrollTo:function(t,a){return this.each(function(){var e=s(this).offset().top;s("html,body").animate({scrollTop:e},t,a)})}}),s("html").scrollTo(1e3)},noSpaceBlur:function(){s(this).val(s(this).val().replace(/\s/g,""))},noSpaceKeyDown:function(e){if(32==e.keyCode)return!1},autoTab:function(e){var a=[];s(e+" input[maxlength], "+e+' input[type="radio"], '+e+" select, "+e+' input[type="checkbox"]').each(function(e,t){a.push(s(t).attr("tabindex")+" "+s(t).attr("id"))}),s(e+" input[maxlength]").on("keyup",function(e){-1==s.inArray(e.keyCode,[9,16,37,38,39,40])&&Marisa.components["page:tools"].maxLengthToAutoTab(s(this),a)})},maxLengthToAutoTab:function(e,t){var a;e.val().length>=e.attr("maxlength")&&((a=s.inArray(e.attr("tabindex")+" "+e.attr("id"),t)+1)<t.length&&s("#"+e.parents("form").attr("id")+" #"+t[a].split(" ")[1]).focus())},getParametersFromUrlToCookies:function(){var e=location.href.split("?")[1];e&&((e=e.split("&")).length,s(e).each(function(e,t){var a=t.split("=")[0],t=t.split("=")[1];0<=s.inArray(a,["utm_source","utm_medium","utm_campaign","utm_term","utm_content"])&&!s.cookie(a)&&s.cookie(a,t,{expires:5,path:"/"})}))},isValidEmail:function(e){s(e).removeClass("inpt_error"),s(e+" + .span_error").remove();var t=s(e).val(),a=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t);if(""!==t)return!!a||(s(e).addClass("inpt_error"),s(e).after("<span id='error_"+s(e).attr("id")+"' class='span_error'>Insira um formato de e-mail válido.<span>"),!1)},loaderMaster:function(e){1==e&&(0==s("#loader").length&&s("body").append(' <div id="loader" class="bgLoader hidden"> <div class="loader"></div></div> '),s("#loader").removeClass("hidden")),0==e&&s("#loader").addClass("hidden")},loaderStoreList:function(e){!0===e&&(s("#omniStoreList").append('<div id="loaderStore" class="storeLoader"> <div class="loader"></div></div>'),s("#loaderStore").removeClass("hidden")),!1===e&&s("#loader").addClass("hidden")},validaCaracteres:function(e){for(var t=e.toUpperCase(),a="áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ",n="",o=0;o<e.length;o++)-1!=a.indexOf(e.charAt(o))?n+="aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC".substr(a.search(e.substr(o,1)),1):n+=e.substr(o,1);return t==n.replace(/[^a-zA-Z 0-9]/g,"").toUpperCase()},sanitizePersonalFields:function(){var t=/((?![\w\d\sáéíóúâêîôûãẽĩõũàèìòùäëïöüçñÁÉÍÓÚÂÊÎÔÛÃẼĨÕŨÀÈÌÒÙÄËÏÖÜÇÑ'"`\~\^\,\.\(\)\-\+\&\º\ª\/\\\?\!\|\*\%\#\°]).)/gm,a=/[\D]/g,e=s(".allowOnlyCommonCharactersGlobal"),n=s(".allowOnlyDigits");e.keypress(function(e){s(e).attr("key").match(t)&&e.preventDefault()}),e.focusout(function(){s(this).val(s(this).val().replace(t,""))}),n.keypress(function(e){s(e).attr("key").match(a)&&e.preventDefault()}),n.focusout(function(){s(this).val(s(this).val().replace(a,""))})},sizeOfThings:function(){return{windowWidth:window.innerWidth,windowHeight:window.innerHeight,screenWidth:screen.width,screenHeight:screen.height}},validateDistrict:function(e){return s(e).val().length<3?(s(".js-show-invalid-district").remove(),s(e).after('<span class="has-error js-show-invalid-district d-block p-b-12"><span class="help-block">O bairro deve ter no mínimo 3 caracteres</span></span>'),Marisa.components["page:tools"].loaderMaster(!1),!1):(s(".js-show-invalid-district").remove(),!0)},validaForms:function(e){const a=this;s(e+" .inpt_error").removeClass("inpt_error"),s(e+" .span_error").remove(),s("form"+e+" input[required=true]").each(function(e,t){s(t).hasClass("hidden")||s(t).parent().hasClass("hidden")||s(t).parent().parent().hasClass("hidden")||s(t).parent().parent().parent().hasClass("hidden")||s(t).parent().parent().parent().parent().hasClass("hidden")||""==s(t).val().trim()&&a.inValidInput(t,"Informe "+s(t).attr("data-lbkey"))}),s("form"+e+" select[required=true]").each(function(e,t){s(t).hasClass("hidden")||s(t).parent().hasClass("hidden")||s(t).parent().parent().hasClass("hidden")||s(t).parent().parent().parent().hasClass("hidden")||s(t).parent().parent().parent().parent().hasClass("hidden")||""!=s(t).val()&&null!=s(t).val()||a.inValidInput(t,"Informe "+s(t).attr("data-lbkey"))}),s("form"+e+" textarea[required=true]").each(function(e,t){s(t).hasClass("hidden")||s(t).parent().hasClass("hidden")||s(t).parent().parent().hasClass("hidden")||s(t).parent().parent().parent().hasClass("hidden")||s(t).parent().parent().parent().parent().hasClass("hidden")||""!=s(t).val().trim()&&null!=s(t).val()||a.inValidInput(t,"Informe "+s(t).attr("data-lbkey"))})},inValidInput:function(e,t){s(e).addClass("inpt_error"),t&&s(e).after(`<span id="error_${s(e).attr("id")}" class="span_error"> ${t} </span>`)},validInput:function(e){s(e).removeClass("inpt_error"),s(e).siblings(".span_error").remove()},getEnter(e,t){s(document).on("keyup",e,e=>{13==e.keyCode&&t()})},noSection:function(e){var t;return Marisa.components["page:tools"].loaderMaster(!0),-1<e.indexOf("loginForm")?(t=location.pathname,s("body").after('<form id="formWel" action=" '+t+' " method="GET"></form>'),s("#formWel").submit(),""):(Marisa.components["page:tools"].loaderMaster(!1),e)},testEndSubStr:function(e,t){var a=t.length;return e.substr(e.length-a,e.length)==t},checkValid:function(e){return!(0<s(e).find(".inpt_error").length)},validaNome:function(e){var t=e.val().split(" ");""!=t[0]&&""!=t[1]||(e.val(""),t=e.val().split(" ")),e.attr("name");return!(t.length<=1)||(s("#"+e.attr("name")+"_error").remove(),e.after('<span id="'+e.attr("name")+'_error" class="span_error">Informe '+e.attr("data-lbkey")+"</span>"),e.addClass("inpt_error"),e.focus(),!1)},addToCart:function(e){var n=s("#form--add-product-to-cart");Marisa.components["page:tools"].loaderMaster(!0),s(e).each(function(e,t){n.find('input[name="productCodePost"]').val(t.code),n.find('input[name="qty"]').val(t.qtd);var t=n.serialize(),a=ACC.config.encodedContextPath+"/cart/add";s.ajax({url:a,type:"POST",cache:!1,async:!1,data:t}).done(function(e,t,a){403==a.status||1==JSON.stringify(e).indexOf("<")||0==JSON.stringify(e).indexOf("<")?(localStorage.clear(),s("#modal--add-to-cart").modal().find(".modal-body").html("Ops! Sua sessão expirou, tente novamente."),setTimeout(function(){location.reload()},500)):(s("#modal--add-to-cart").modal().find(".modal-body").html(e.addToCartLayer),Marisa.components["page:tools"].asyncHeaderWhippet("cart",c))}).fail(function(){console.log("error")})}),"cartPage"==s("body").attr("data-page-uid")&&location.reload(),Marisa.components["page:tools"].loaderMaster(!1)},removeErrorForm:function(){s(document).on("keyup",".has-error input",function(){s(this).parents(".has-error").removeClass("error").removeClass("has-error").find(".help-block").remove()}),s(document).on("keyup",".inpt_error",function(){var e=s(this);e.removeClass("inpt_error"),e.siblings(".span_error").remove()})},listeners:function(){return this},triggers:function(){return this},lowerCaseEmails:function(){s("input[name=email],input[name=chkEmail]").on("focusout",function(){var e=s(this).val().toLowerCase();s(this).val(e)})},lgpd:function(){setTimeout(function(){s(".js-lgpd").removeClass("hide")},500),s(document).ready(function(){var t=localStorage.getItem("LGPDcookie",!0),a=s.cookie("LGPDcookie",!0,{domain:".marisa.com.br"});function e(e){e?(localStorage.setItem("LGPDcookie",!0),s.cookie("LGPDcookie",!0,{domain:".marisa.com.br"})):(a||t)&&s(".js-lgpd").hide()}e(),s(".js-lgpd-btn").click(function(){s(".js-lgpd").fadeToggle("slow"),e(!0)})})},asyncHeaderWhippet:function(n,o){var e="",r=s(document).find("body").data("intima"),t=r?"/l/":"/";0<o.length&&a&&(o="user"===n?(e=ACC.config.marisaAsyncContextPath+t+"user/loggedUser",l):(e=ACC.config.marisaAsyncContextPath+t+"cart/async",c),s.ajax({url:e,type:"GET",cache:!1,async:!0,beforeSend:function(){o.html('<i class="loading-icon"></i>')}}).done(function(e,t,a){403===a.status?console.error("Error - 403: "+n):(o.html(e),"cart"===n?i.components["cart:floating-bag"].listeners().triggers():r?(a=s(document).find(".js-menu-intima-elements-to-clone").clone(),o.find(".content ul li:first-child").after(a.removeClass("hidden"))):s('.js-load-users-menu a[data-action="menubar:open-submenu"]').on("click",function(e){e.preventDefault(),s(this).siblings(".collapse").collapse("toggle")}))}).fail(function(){o.html('<i class="loading-icon"></i>'),console.error("Something when wrong to load the component "+n)}))},removeDimensions(e){const t=e.attr("style")&&e.attr("style").replace(/ /g,"").split(";");let a="";""!=(a=t&&1<=t.length?(a=(a=t.filter(e=>!e.includes("height"))).filter(e=>!e.includes("width"))).join().replace(/,/g,"; "):a)?e.attr("style",a):e.removeAttr("style")}})}(Marisa,jQuery);const tools=Marisa.components["page:tools"],loader=Marisa.components["page:tools"].loaderMaster;