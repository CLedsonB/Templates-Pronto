ACC.storefinder={_autoload:[["init",0!=$(".js-store-finder").length],["bindStoreChange",0!=$(".js-store-finder").length],["bindSearch",0!=$(".js-store-finder").length],"bindPagination"],storeData:"",storeId:"",coords:{},storeSearchData:{},createListItemHtml:function(e,t){var r="";return(r+='<li class="list__entry">')+('<input type="radio" name="storeNamePost" value="'+e.displayName+'" id="store-filder-entry-'+t+'" class="js-store-finder-input" data-id="'+t+'">')+('<label for="store-filder-entry-'+t+'" class="js-select-store-label">')+'<span class="entry__info">'+('<span class="entry__name">'+e.displayName+"</span>")+('<span class="entry__address">'+e.line1+" "+e.line2+"</span>")+('<span class="entry__city">'+e.town+"</span>")+"</span>"+'<span class="entry__distance">'+("<span>"+e.formattedDistance+"</span>")+"</span>"+"</label>"+"</li>"},refreshNavigation:function(){var e="";if(data=ACC.storefinder.storeData){for(i=0;i<data.data.length;i++)e+=ACC.storefinder.createListItemHtml(data.data[i],i);$(".js-store-finder-navigation-list").html(e);var t=$(".js-store-finder-input")[0];$(t).click()}t=ACC.storefinder.storeSearchData.page,$(".js-store-finder-pager-item-from").html(10*t+1),t=10*t+10>ACC.storefinder.storeData.total?ACC.storefinder.storeData.total:10*t+10;$(".js-store-finder-pager-item-to").html(t),$(".js-store-finder-pager-item-all").html(ACC.storefinder.storeData.total),$(".js-store-finder").removeClass("show-store")},bindPagination:function(){function t(e){0==e?$(".js-store-finder-pager-prev").attr("disabled","disabled"):$(".js-store-finder-pager-prev").removeAttr("disabled"),e==Math.floor(ACC.storefinder.storeData.total/10)?$(".js-store-finder-pager-next").attr("disabled","disabled"):$(".js-store-finder-pager-next").removeAttr("disabled")}$(document).on("click",".js-store-finder-details-back",function(e){e.preventDefault(),$(".js-store-finder").removeClass("show-store")}),$(document).on("click",".js-store-finder-pager-prev",function(e){e.preventDefault();e=ACC.storefinder.storeSearchData.page;ACC.storefinder.getStoreData(e-1),t(e-1)}),$(document).on("click",".js-store-finder-pager-next",function(e){e.preventDefault();e=ACC.storefinder.storeSearchData.page;ACC.storefinder.getStoreData(e+1),t(e+1)})},bindStoreChange:function(){$(document).on("change",".js-store-finder-input",function(e){e.preventDefault(),storeData=ACC.storefinder.storeData.data;var e=$(this).data("id"),s=$(".js-store-finder-details"),n=$(".js-tittle-open-hours"),i=$(".js-tittle-open-hours-closed"),d=!0;$.each(storeData[e],function(e,t){var r,o,a;"closed"==e&&(0==t?(d=!1,i.addClass("hidden"),n.removeClass("hidden")):d=!0),"closedMessage"==e&&d&&(n.addClass("hidden"),i.html("<p>"+t+"</p>"),i.removeClass("hidden")),"image"==e?""!=t?s.find(".js-store-image").html('<img src="'+t+'" alt="" />'):s.find(".js-store-image").html(""):"productcode"==e?s.find(".js-store-productcode").val(t):"openings"!=e||d?"specialOpenings"!=e&&("features"==e?(r="",$.each(t,function(e,t){r+="<li>"+t+"</li>"}),s.find(".js-store-"+e).html(r)):""!=t?s.find(".js-store-"+e).html(t):s.find(".js-store-"+e).html("")):""!=t?(o=s.find(".js-store-"+e),a="",$.each(t,function(e){a+="<p class='m-0'>"+t[e].BeginDay+(t[e].EndDay?"-"+t[e].EndDay:"")+": "+t[e].BeginHour+"-"+t[e].EndHour+"h</p>"}),o.html(a)):s.find(".js-store-"+e).html("")}),ACC.storefinder.storeId=storeData[e],ACC.storefinder.initGoogleMap()}),$(document).on("click",".js-select-store-label",function(e){$(".js-store-finder").addClass("show-store")}),$(document).on("click",".js-back-to-storelist",function(e){$(".js-store-finder").removeClass("show-store")})},initGoogleMap:function(){0<$(".js-store-finder-map").length&&ACC.global.addGoogleMapsApi("ACC.storefinder.loadGoogleMap")},loadGoogleMap:function(){var e,t,r,o;storeInformation=ACC.storefinder.storeId,0<$(".js-store-finder-map").length&&($(".js-store-finder-map").attr("id","store-finder-map"),e=new google.maps.LatLng(storeInformation.latitude,storeInformation.longitude),e={zoom:13,zoomControl:!0,panControl:!0,streetViewControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,center:e},t=new google.maps.Map(document.getElementById("store-finder-map"),e),r=new google.maps.Marker({position:new google.maps.LatLng(storeInformation.latitude,storeInformation.longitude),map:t,title:storeInformation.name,icon:"https://maps.google.com/mapfiles/markerA.png"}),o=new google.maps.InfoWindow({content:storeInformation.name,disableAutoPan:!0}),google.maps.event.addListener(r,"click",function(){o.open(t,r)}))},bindSearch:function(){$(document).on("click","#storeFinderForm button",function(e){var t,r;e.preventDefault(),Marisa.components["page:tools"].validaForms("#storeFinderForm"),Marisa.components["page:tools"].checkValid("#storeFinderForm")&&(0<(e=$(".js-store-finder-search-input").val()).length?(r=t="",$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?key="+ACC.config.googleApiKey+"&sensor=false&address="+e,type:"GET",dataType:"json",async:!1}).done(function(e){"ZERO_RESULTS"!=e.status&&(t=e.results[0].geometry.location.lat,r=e.results[0].geometry.location.lng)}).fail(function(e){console.log(e)}),ACC.storefinder.getInitStoreData(e,t,r)):$(".js-storefinder-alert").length<1&&(e=$(".btn-primary").data("searchEmpty"),$(".js-store-finder").hide(),$("#storeFinder").before('<div class="js-storefinder-alert alert alert-danger alert-dismissable" ><button class="close" type="button" data-dismiss="alert" aria-hidden="true">×</button>'+e+"</div>")))}),$(".js-store-finder").hide(),$(document).on("click","#findStoresNearMe",function(e){e.preventDefault(),ACC.storefinder.getInitStoreData(null,ACC.storefinder.coords.latitude,ACC.storefinder.coords.longitude)})},getStoreData:function(e){ACC.storefinder.storeSearchData.page=e,url=$(".js-store-finder").data("url"),$.ajax({url:url,data:ACC.storefinder.storeSearchData,type:"get",success:function(e){0!=e.indexOf("<")?(ACC.storefinder.storeData=$.parseJSON(e),ACC.storefinder.refreshNavigation(),ACC.storefinder.storeData.total<10&&$(".js-store-finder-pager-next").attr("disabled","disabled")):($("#storeFinder").parents(".container").before('<div class="global-alerts container"> <div class="alert alert-danger alert-dismissable"> <button class="close" aria-hidden="true" data-dismiss="alert" type="button">×</button> Verifique se você digitou um CEP ou um nome de local válido.</div></div>'),$(".js-store-finder").hide())}})},getInitStoreData:function(e,t,r){$(".alert").remove(),data={q:"",page:0},null!=e&&(data.q=e),null!=t&&(data.latitude=t),null!=r&&(data.longitude=r),ACC.storefinder.storeSearchData=data,ACC.storefinder.getStoreData(data.page),$(".js-store-finder").show(),$(".js-store-finder-pager-prev").attr("disabled","disabled"),$(".js-store-finder-pager-next").removeAttr("disabled")},init:function(){$("#findStoresNearMe").attr("disabled","disabled"),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){ACC.storefinder.coords=e.coords,$("#findStoresNearMe").removeAttr("disabled")},function(e){console.log("An error occurred... The error code and message are: "+e.code+"/"+e.message)})}};