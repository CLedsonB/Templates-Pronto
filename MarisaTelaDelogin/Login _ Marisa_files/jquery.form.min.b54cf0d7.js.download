!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(M){"use strict";function r(e){var t=e.data;e.isDefaultPrevented()||(e.preventDefault(),M(e.target).ajaxSubmit(t))}function a(e){var t=e.target,r=M(t);if(!r.is("[type=submit],[type=image]")){var a=r.closest("[type=submit]");if(0===a.length)return;t=a[0]}var n=this;"image"==(n.clk=t).type&&(void 0!==e.offsetX?(n.clk_x=e.offsetX,n.clk_y=e.offsetY):"function"==typeof M.fn.offset?(a=r.offset(),n.clk_x=e.pageX-a.left,n.clk_y=e.pageY-a.top):(n.clk_x=e.pageX-t.offsetLeft,n.clk_y=e.pageY-t.offsetTop)),setTimeout(function(){n.clk=n.clk_x=n.clk_y=null},100)}function F(){var e;M.fn.ajaxSubmit.debug&&(e="[jquery.form] "+Array.prototype.join.call(arguments,""),window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e))}var h={},O=(h.fileapi=void 0!==M("<input type='file'/>").get(0).files,h.formdata=void 0!==window.FormData,!!M.fn.prop);M.fn.attr2=function(){if(!O)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||"string"==typeof e?e:this.attr.apply(this,arguments)},M.fn.ajaxSubmit=function(u){function e(e){function c(t){var r=null;try{t.contentWindow&&(r=t.contentWindow.document)}catch(t){F("cannot get iframe.contentWindow document: "+t)}if(r)return r;try{r=t.contentDocument||t.document}catch(e){F("cannot get iframe.contentDocument: "+e),r=t.document}return r}function t(){var e=E.attr2("target"),t=E.attr2("action"),r=E.attr("enctype")||E.attr("encoding")||"multipart/form-data",a=(i.setAttribute("target",o),A&&!/post/i.test(A)||i.setAttribute("method","POST"),t!=f.url&&i.setAttribute("action",f.url),f.skipEncodingOverride||A&&!/post/i.test(A)||E.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(v=setTimeout(function(){g=!0,l(b)},f.timeout)),[]);try{if(f.extraData)for(var n in f.extraData)f.extraData.hasOwnProperty(n)&&a.push((M.isPlainObject(f.extraData[n])&&f.extraData[n].hasOwnProperty("name")&&f.extraData[n].hasOwnProperty("value")?M('<input type="hidden" name="'+f.extraData[n].name+'">').val(f.extraData[n].value):M('<input type="hidden" name="'+n+'">').val(f.extraData[n])).appendTo(i)[0]);f.iframeTarget||p.appendTo("body"),d.attachEvent?d.attachEvent("onload",l):d.addEventListener("load",l,!1),setTimeout(function e(){try{var t=c(d).readyState;F("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(t){F("Server abort: ",t," (",t.name,")"),l(y),v&&clearTimeout(v),v=void 0}},15);try{i.submit()}catch(e){document.createElement("form").submit.apply(i)}}finally{i.setAttribute("action",t),i.setAttribute("enctype",r),e?i.setAttribute("target",e):E.removeAttr("target"),M(a).remove()}}function l(t){if(!h.aborted&&!w){if((j=c(d))||(F("cannot access response document"),t=y),t===b&&h)return h.abort("timeout"),void x.reject(h,"timeout");if(t==y&&h)return h.abort("server abort"),void x.reject(h,"error","server abort");if(j&&j.location.href!=f.iframeSrc||g){d.detachEvent?d.detachEvent("onload",l):d.removeEventListener("load",l,!1);var r,t="success";try{if(g)throw"timeout";var e="xml"==f.dataType||j.XMLDocument||M.isXMLDoc(j);if(F("isXml="+e),!e&&window.opera&&(null===j.body||!j.body.innerHTML)&&--S)return F("requeing onLoad callback, DOM not available"),void setTimeout(l,250);var a,n,o,i=j.body||j.documentElement,s=(h.responseText=i?i.innerHTML:null,h.responseXML=j.XMLDocument||j,e&&(f.dataType="xml"),h.getResponseHeader=function(e){return{"content-type":f.dataType}[e.toLowerCase()]},i&&(h.status=Number(i.getAttribute("status"))||h.status,h.statusText=i.getAttribute("statusText")||h.statusText),(f.dataType||"").toLowerCase()),u=/(json|script|text)/.test(s);u||f.textarea?(a=j.getElementsByTagName("textarea")[0])?(h.responseText=a.value,h.status=Number(a.getAttribute("status"))||h.status,h.statusText=a.getAttribute("statusText")||h.statusText):u&&(n=j.getElementsByTagName("pre")[0],o=j.getElementsByTagName("body")[0],n?h.responseText=n.textContent||n.innerText:o&&(h.responseText=o.textContent||o.innerText)):"xml"==s&&!h.responseXML&&h.responseText&&(h.responseXML=k(h.responseText));try{T=D(h,s,f)}catch(e){t="parsererror",h.error=r=e||t}}catch(e){F("error caught: ",e),t="error",h.error=r=e||t}h.aborted&&(F("upload aborted"),t=null),"success"===(t=h.status?200<=h.status&&h.status<300||304===h.status?"success":"error":t)?(f.success&&f.success.call(f.context,T,"success",h),x.resolve(h.responseText,"success",h),m&&M.event.trigger("ajaxSuccess",[h,f])):t&&(void 0===r&&(r=h.statusText),f.error&&f.error.call(f.context,h,t,r),x.reject(h,"error",r),m&&M.event.trigger("ajaxError",[h,f,r])),m&&M.event.trigger("ajaxComplete",[h,f]),m&&!--M.active&&M.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,h,t),w=!0,f.timeout&&clearTimeout(v),setTimeout(function(){f.iframeTarget?p.attr("src",f.iframeSrc):p.remove(),h.responseXML=null},100)}}}var r,a,f,m,o,p,d,h,g,v,i=E[0],x=M.Deferred();if(x.abort=function(e){h.abort(e)},e)for(a=0;a<L.length;a++)r=M(L[a]),O?r.prop("disabled",!1):r.removeAttr("disabled");if((f=M.extend(!0,{},M.ajaxSettings,u)).context=f.context||f,o="jqFormIO"+(new Date).getTime(),f.iframeTarget?(n=(p=M(f.iframeTarget)).attr2("name"))?o=n:p.attr2("name",o):(p=M('<iframe name="'+o+'" src="'+f.iframeSrc+'" />')).css({position:"absolute",top:"-1000px",left:"-1000px"}),d=p[0],h={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var t="timeout"===e?"timeout":"aborted";F("aborting upload... "+t),this.aborted=1;try{d.contentWindow.document.execCommand&&d.contentWindow.document.execCommand("Stop")}catch(e){}p.attr("src",f.iframeSrc),h.error=t,f.error&&f.error.call(f.context,h,t,e),m&&M.event.trigger("ajaxError",[h,f,t]),f.complete&&f.complete.call(f.context,h,t)}},(m=f.global)&&0==M.active++&&M.event.trigger("ajaxStart"),m&&M.event.trigger("ajaxSend",[h,f]),f.beforeSend&&!1===f.beforeSend.call(f.context,h,f))return f.global&&M.active--,x.reject(),x;if(h.aborted)return x.reject(),x;(e=i.clk)&&(n=e.name)&&!e.disabled&&(f.extraData=f.extraData||{},f.extraData[n]=e.value,"image"==e.type&&(f.extraData[n+".x"]=i.clk_x,f.extraData[n+".y"]=i.clk_y));var b=1,y=2,e=M("meta[name=csrf-token]").attr("content"),n=M("meta[name=csrf-param]").attr("content");n&&e&&(f.extraData=f.extraData||{},f.extraData[n]=e),f.forceSync?t():setTimeout(t,10);var T,j,w,S=50,k=M.parseXML||function(e,t){return window.ActiveXObject?((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},s=M.parseJSON||function(e){return window.eval("("+e+")")},D=function(e,t,r){var a=e.getResponseHeader("content-type")||"",n="xml"===t||!t&&0<=a.indexOf("xml"),e=n?e.responseXML:e.responseText;return n&&"parsererror"===e.documentElement.nodeName&&M.error&&M.error("parsererror"),"string"==typeof(e=r&&r.dataFilter?r.dataFilter(e,t):e)&&("json"===t||!t&&0<=a.indexOf("json")?e=s(e):("script"===t||!t&&0<=a.indexOf("javascript"))&&M.globalEval(e)),e};return x}if(!this.length)return F("ajaxSubmit: skipping submit process - no element selected"),this;var A,E=this,t=("function"==typeof u?u={success:u}:void 0===u&&(u={}),A=u.type||this.attr2("method"),(t=(t="string"==typeof(t=u.url||this.attr2("action"))?M.trim(t):"")||window.location.href||"")&&(t=(t.match(/^([^#]+)/)||[])[1]),u=M.extend(!0,{url:t,success:M.ajaxSettings.success,type:A||M.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},u),{});if(this.trigger("form-pre-serialize",[this,u,t]),t.veto)return F("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(u.beforeSerialize&&!1===u.beforeSerialize(this,u))return F("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var r=u.traditional;void 0===r&&(r=M.ajaxSettings.traditional);var L=[],a=this.formToArray(u.semantic,L);if(u.data&&(u.extraData=u.data,l=M.param(u.data,r)),u.beforeSubmit&&!1===u.beforeSubmit(a,this,u))return F("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,u,t]),t.veto)return F("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var n,o,i,s,t=M.param(a,r),c=(l&&(t=t?t+"&"+l:l),"GET"==u.type.toUpperCase()?(u.url+=(0<=u.url.indexOf("?")?"&":"?")+t,u.data=null):u.data=t,[]),r=(u.resetForm&&c.push(function(){E.resetForm()}),u.clearForm&&c.push(function(){E.clearForm(u.includeHidden)}),!u.dataType&&u.target?(n=u.success||function(){},c.push(function(e){var t=u.replaceTarget?"replaceWith":"html";M(u.target)[t](e).each(n,arguments)})):u.success&&c.push(u.success),u.success=function(e,t,r){for(var a=u.context||this,n=0,o=c.length;n<o;n++)c[n].apply(a,[e,t,r||E,E])},u.error&&(o=u.error,u.error=function(e,t,r){var a=u.context||this;o.apply(a,[e,t,r,E])}),u.complete&&(i=u.complete,u.complete=function(e,t){var r=u.context||this;i.apply(r,[e,t,E])}),0<M("input[type=file]:enabled",this).filter(function(){return""!==M(this).val()}).length),l="multipart/form-data",t=E.attr("enctype")==l||E.attr("encoding")==l,l=h.fileapi&&h.formdata;F("fileAPI :"+l),!1!==u.iframe&&(u.iframe||(r||t)&&!l)?u.closeKeepAlive?M.get(u.closeKeepAlive,function(){s=e(a)}):s=e(a):s=(r||t)&&l?function(e){for(var r=new FormData,t=0;t<e.length;t++)r.append(e[t].name,e[t].value);if(u.extraData)for(var a=function(e){for(var t,r=M.param(e,u.traditional).split("&"),a=r.length,n=[],o=0;o<a;o++)r[o]=r[o].replace(/\+/g," "),t=r[o].split("="),n.push([decodeURIComponent(t[0]),decodeURIComponent(t[1])]);return n}(u.extraData),t=0;t<a.length;t++)a[t]&&r.append(a[t][0],a[t][1]);u.data=null;var n=M.extend(!0,{},M.ajaxSettings,u,{contentType:!1,processData:!1,cache:!1,type:A||"POST"}),o=(u.uploadProgress&&(n.xhr=function(){var e=M.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){var t=0,r=e.loaded||e.position,a=e.total;e.lengthComputable&&(t=Math.ceil(r/a*100)),u.uploadProgress(e,r,a,t)},!1),e}),n.data=null,n.beforeSend);return n.beforeSend=function(e,t){t.data=u.formData||r,o&&o.call(this,e,t)},M.ajax(n)}(a):M.ajax(u),E.removeData("jqxhr").data("jqxhr",s);for(var f=0;f<L.length;f++)L[f]=null;return this.trigger("form-submit-notify",[this,u]),this},M.fn.ajaxForm=function(e){var t;return(e=e||{}).delegation=e.delegation&&M.isFunction(M.fn.on),e.delegation||0!==this.length?e.delegation?(M(document).off("submit.form-plugin",this.selector,r).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,e,r).on("click.form-plugin",this.selector,e,a),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,r).bind("click.form-plugin",e,a):(t={s:this.selector,c:this.context},!M.isReady&&t.s?(F("DOM not ready, queuing ajaxForm"),M(function(){M(t.s,t.c).ajaxForm(e)})):F("terminating; zero elements found by selector"+(M.isReady?"":" (DOM not ready)")),this)},M.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},M.fn.formToArray=function(e,t){var r=[];if(0===this.length)return r;var a,n,o,i,s,u,c,l,f=this[0],m=this.attr("id"),p=e?f.getElementsByTagName("*"):f.elements;if(p&&!/MSIE [678]/.test(navigator.userAgent)&&(p=M(p).get()),!(p=m&&(m=M(':input[form="'+m+'"]').get()).length?(p||[]).concat(m):p)||!p.length)return r;for(a=0,u=p.length;a<u;a++)if((o=(s=p[a]).name)&&!s.disabled)if(e&&f.clk&&"image"==s.type)f.clk==s&&(r.push({name:o,value:M(s).val(),type:s.type}),r.push({name:o+".x",value:f.clk_x},{name:o+".y",value:f.clk_y}));else if((i=M.fieldValue(s,!0))&&i.constructor==Array)for(t&&t.push(s),n=0,c=i.length;n<c;n++)r.push({name:o,value:i[n]});else if(h.fileapi&&"file"==s.type){t&&t.push(s);var d=s.files;if(d.length)for(n=0;n<d.length;n++)r.push({name:o,value:d[n],type:s.type});else r.push({name:o,value:"",type:s.type})}else null!=i&&(t&&t.push(s),r.push({name:o,value:i,type:s.type,required:s.required}));return!e&&f.clk&&(o=(l=(m=M(f.clk))[0]).name)&&!l.disabled&&"image"==l.type&&(r.push({name:o,value:m.val()}),r.push({name:o+".x",value:f.clk_x},{name:o+".y",value:f.clk_y})),r},M.fn.formSerialize=function(e){return M.param(this.formToArray(e))},M.fn.fieldSerialize=function(n){var o=[];return this.each(function(){var e=this.name;if(e){var t=M.fieldValue(this,n);if(t&&t.constructor==Array)for(var r=0,a=t.length;r<a;r++)o.push({name:e,value:t[r]});else null!=t&&o.push({name:this.name,value:t})}}),M.param(o)},M.fn.fieldValue=function(e){for(var t=[],r=0,a=this.length;r<a;r++){var n=this[r],n=M.fieldValue(n,e);null==n||n.constructor==Array&&!n.length||(n.constructor==Array?M.merge(t,n):t.push(n))}return t},M.fieldValue=function(e,t){var r=e.name,a=e.type,n=e.tagName.toLowerCase();if((t=void 0===t?!0:t)&&(!r||e.disabled||"reset"==a||"button"==a||("checkbox"==a||"radio"==a)&&!e.checked||("submit"==a||"image"==a)&&e.form&&e.form.clk!=e||"select"==n&&-1==e.selectedIndex))return null;if("select"!=n)return M(e).val();t=e.selectedIndex;if(t<0)return null;for(var o=[],i=e.options,s="select-one"==a,u=s?t+1:i.length,c=s?t:0;c<u;c++){var l=i[c];if(l.selected){var f=(f=l.value)||(l.attributes&&l.attributes.value&&!l.attributes.value.specified?l.text:l.value);if(s)return f;o.push(f)}}return o},M.fn.clearForm=function(e){return this.each(function(){M("input,select,textarea",this).clearFields(e)})},M.fn.clearFields=M.fn.clearInputs=function(r){var a=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();a.test(e)||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t?this.selectedIndex=-1:"file"==e?/MSIE/.test(navigator.userAgent)?M(this).replaceWith(M(this).clone(!0)):M(this).val(""):r&&(!0===r&&/hidden/.test(e)||"string"==typeof r&&M(this).is(r))&&(this.value="")})},M.fn.resetForm=function(){return this.each(function(){"function"!=typeof this.reset&&("object"!=typeof this.reset||this.reset.nodeType)||this.reset()})},M.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},M.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var e=this.type;"checkbox"==e||"radio"==e?this.checked=t:"option"==this.tagName.toLowerCase()&&(e=M(this).parent("select"),t&&e[0]&&"select-one"==e[0].type&&e.find("option").selected(!1),this.selected=t)})},M.fn.ajaxSubmit.debug=!1});